var FirstPersonMovement=pc.createScript("firstPersonMovement");FirstPersonMovement.attributes.add("camera",{type:"entity",description:"Optional, assign a camera entity, otherwise one is created"}),FirstPersonMovement.attributes.add("power",{type:"number",default:2500,description:"Adjusts the speed of player movement"}),FirstPersonMovement.attributes.add("lookSpeed",{type:"number",default:.25,description:"Adjusts the sensitivity of looking"}),FirstPersonMovement.attributes.add("autoMouseLock",{type:"number",default:.25,description:"Adjusts the sensitivity of looking"}),FirstPersonMovement.prototype.initialize=function(){this.force=new pc.Vec3,this.eulers=new pc.Vec3,this.allowLock=!0;var t=this.app;t.mouse.on("mousemove",this._onMouseMove,this),this.lastTouchPoint=new pc.Vec2,this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchEnd,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchCancel,this),this.on("destroy",function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchEnd,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchCancel,this)})),t.mouse.enablePointerLock(),this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.entity.collision||console.error("First Person Movement script needs to have a 'collision' component"),this.entity.rigidbody&&this.entity.rigidbody.type===pc.BODYTYPE_DYNAMIC||console.error("First Person Movement script needs to have a DYNAMIC 'rigidbody' component")},FirstPersonMovement.prototype.update=function(t){this.camera||this._createCamera();var e=this.force,o=this.app,s=this.camera.forward,i=this.camera.right,r=0,n=0;(o.keyboard.isPressed(pc.KEY_A)||o.keyboard.isPressed(pc.KEY_Q))&&(r-=i.x,n-=i.z),o.keyboard.isPressed(pc.KEY_D)&&(r+=i.x,n+=i.z),o.keyboard.isPressed(pc.KEY_W)&&(r+=s.x,n+=s.z),o.keyboard.isPressed(pc.KEY_S)&&(r-=s.x,n-=s.z),this.app.keyboard.isPressed(pc.KEY_RETURN)||this.app.keyboard.isPressed(pc.KEY_RETURN),0!==r&&0!==n&&(e.set(r,0,n).normalize().scale(this.power),this.entity.rigidbody.applyForce(e))},FirstPersonMovement.prototype._onMouseMove=function(t){pc.Mouse.isPointerLocked()&&this.allowLock&&(this.eulers.x-=this.lookSpeed*t.dx,this.eulers.y-=this.lookSpeed*t.dy,this.camera.setLocalEulerAngles(pc.math.clamp(this.eulers.y,-60,60),this.eulers.x,0))},FirstPersonMovement.prototype.onMouseDown=function(t){this.allowLock&&this.app.mouse.enablePointerLock()},FirstPersonMovement.prototype.onTouchStart=function(t){var e=t.touches[0];this.lastTouchPoint.set(e.x,e.y)},FirstPersonMovement.prototype.onTouchMove=function(t){var e=t.touches[0],o=e.x-this.lastTouchPoint.x,s=e.y-this.lastTouchPoint.y;this.eulers.x-=this.lookSpeed*o*3,this.eulers.y-=this.lookSpeed*s*3,this.camera.setLocalEulerAngles(pc.math.clamp(this.eulers.y,-60,60),this.eulers.x,0),this.lastTouchPoint.set(e.x,e.y)},FirstPersonMovement.prototype._createCamera=function(){this.camera=new pc.Entity,this.camera.setName("First Person Camera"),this.camera.addComponent("camera"),this.entity.addChild(this.camera),this.camera.translateLocal(0,.5,0)};var Marker=pc.createScript("marker");Marker.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),Marker.attributes.add("markerEntity",{type:"entity",title:"Marker Entity"}),Marker.attributes.add("aimEntity",{type:"entity",title:"Aim Entity"}),Marker.attributes.add("ringEntity",{type:"entity",title:"Ring Entity"}),Marker.attributes.add("allowScanning",{type:"boolean",default:!0,title:"Scanning Bool"}),Marker.attributes.add("allowPulse",{type:"boolean",default:!0,title:"Aim Bool"}),Marker.prototype.initialize=function(){this.allowMove=!0,this.allowPulse=!0,this.groundShape=new pc.BoundingBox(new pc.Vec3(0,0,8),new pc.Vec3(50,.001,20)),this.direction=new pc.Vec3,this.distanceToTravel=0,this.targetPosition=new pc.Vec3},Marker.prototype.update=function(t){this.allowScanning&&this.overallUpdate()},Marker.ray=new pc.Ray,Marker.hitPosition=new pc.Vec3,Marker.prototype.overallUpdate=function(){var t=Marker.ray,i=Marker.hitPosition,e=this.app.graphicsDevice.width/2,a=this.app.graphicsDevice.height/2,r=this.cameraEntity.camera.screenToWorld(e,a,this.cameraEntity.camera.nearClip),n=this.cameraEntity.camera.screenToWorld(e,a,this.cameraEntity.camera.farClip);this.cameraEntity.camera.screenToWorld(e,a,this.cameraEntity.camera.farClip,t.direction),t.origin.copy(this.cameraEntity.getPosition()),t.direction.sub(t.origin).normalize();var s=this.groundShape.intersectsRay(t,i),o=this.app.systems.rigidbody.raycastFirst(r,n);if(o){var l=o.entity;l.tags.has("Hotspot")?(this.allowMove=!1,this.markerEntity.enabled=!1,this.aimEntity.enabled=!0,this.allowPulse&&(l.script.pulseSingle?l.script.pulseSingle.pulse():console.log("There is no script attached"),this.allowPulse=!1)):l.tags.has("ExitToSite")||l.tags.has("JumpToURLButton")||l.tags.has("AuditoriumSite")?(this.markerEntity.enabled=!1,this.aimEntity.enabled=!0,this.allowPulse&&(l.script.pulseSingle?l.script.pulseSingle.pulse():console.log("There is no script attached"),this.allowPulse=!1)):l.tags.has("Stall")||l.tags.has("RestrictedPlane")?(this.allowMove=!1,this.markerEntity.enabled=!1,this.aimEntity.enabled=!1,this.ringEntity&&(this.ringEntity.enabled=!1)):s&&this.allowPulse?(this.allowMove=!0,this.markerEntity.enabled=!0,this.aimEntity.enabled=!1,this.ringEntity&&(this.ringEntity.enabled=!0),this.moveMarkerTo(i)):s?(this.markerEntity.enabled=!1,this.aimEntity.enabled=!1,this.ringEntity&&(this.ringEntity.enabled=!1),this.allowPulse=!0):(this.allowMove=!0,this.allowPulse=!0,this.markerEntity.enabled=!1,this.aimEntity.enabled=!0,this.ringEntity&&(this.ringEntity.enabled=!1))}},Marker.prototype.doRayCast=function(){var t=Marker.ray,i=Marker.hitPosition,e=this.app.graphicsDevice.width/2,a=this.app.graphicsDevice.height/2;this.cameraEntity.camera.screenToWorld(e,a,this.cameraEntity.camera.farClip,t.direction),t.origin.copy(this.cameraEntity.getPosition()),t.direction.sub(t.origin).normalize();var r=this.groundShape.intersectsRay(t,i);this.cameraEntity.camera.screenToWorld(e,a,this.cameraEntity.camera.nearClip),this.cameraEntity.camera.screenToWorld(e,a,this.cameraEntity.camera.farClip);r?(this.markerEntity.enabled=!0,this.aimEntity.enabled=!1,this.moveMarkerTo(i)):(this.markerEntity.enabled=!1,this.aimEntity.enabled=!0)},Marker.prototype.moveMarkerTo=function(t){this.markerEntity.setPosition(t)};var Lerp=pc.createScript("lerp");Lerp.attributes.add("playerToMove",{type:"entity",title:"Player To Move"}),Lerp.attributes.add("lntmarkerEntity",{type:"entity",title:"LNT Marker Entity"}),Lerp.attributes.add("glenmarkmarkerEntity",{type:"entity",title:"Glenmark Marker Entity"}),Lerp.attributes.add("mercmarkerEntity",{type:"entity",title:"Merc Marker Entity"}),Lerp.prototype.initialize=function(){this.targetPosition=this.entity.getPosition(),this.lerpSpeed=10,this.app.on("playerlerp:lnt",this.lntupdatePosition,this),this.app.on("playerlerp:glenmark",this.glenmarkupdatePosition,this),this.app.on("playerlerp:merc",this.mercupdatePosition,this)},Lerp.prototype.lntupdatePosition=function(){this.targetPosition=this.lntmarkerEntity.getPosition()},Lerp.prototype.glenmarkupdatePosition=function(){this.targetPosition=this.glenmarkmarkerEntity.getPosition()},Lerp.prototype.mercupdatePosition=function(){this.targetPosition=this.mercmarkerEntity.getPosition()},Lerp.prototype.update=function(t){var e=this.playerToMove.getLocalPosition();e.lerp(e,this.targetPosition,this.lerpSpeed*t),this.playerToMove.setLocalPosition(e.x,this.playerToMove.getPosition().y,e.z)};var DistanceCalculator=pc.createScript("distanceCalculator");DistanceCalculator.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),DistanceCalculator.attributes.add("scaleFactor",{type:"number",title:"Scale Factor"}),DistanceCalculator.attributes.add("scaleLimit",{type:"number",title:"Scale Limit"}),DistanceCalculator.prototype.initialize=function(){},DistanceCalculator.prototype.update=function(t){var a=this.cameraEntity.getPosition().distance(this.entity.getPosition());a*this.scaleFactor<=this.scaleLimit&&this.entity.setLocalScale(a*this.scaleFactor,a*this.scaleFactor,a*this.scaleFactor)};var Manager=pc.createScript("manager");Manager.attributes.add("template",{title:"Template",type:"entity"}),Manager.attributes.add("numClones",{title:"Num Clones",type:"number",default:50}),Manager.attributes.add("spread",{title:"Spread",type:"number",default:10}),Manager.prototype.initialize=function(){this.entities=[];for(var t=0;t<this.numClones;t++){var e=this.template.clone();e.enabled=!0,this.app.root.addChild(e),this.entities.push(e)}},Manager.prototype.update=function(t){this.entities.forEach(function(t){t.getPosition().y<-10&&this.reset(t)},this)},Manager.prototype.reset=function(t){};var Movement=pc.createScript("movement");Movement.attributes.add("speed",{type:"number",default:.1,min:.05,max:.5,precision:2,description:"Controls the movement speed"}),Movement.prototype.initialize=function(){this.force=new pc.Vec3},Movement.prototype.update=function(e){var t=0,s=0;if(this.app.keyboard.isPressed(pc.KEY_LEFT)&&(t=-this.speed),this.app.keyboard.isPressed(pc.KEY_RIGHT)&&(t+=this.speed),this.app.keyboard.isPressed(pc.KEY_UP)&&(s=-this.speed),this.app.keyboard.isPressed(pc.KEY_DOWN)&&(s+=this.speed),this.force.x=t,this.force.z=s,this.force.length()){var i=Math.cos(.25*-Math.PI),o=Math.sin(.25*-Math.PI);this.force.set(this.force.x*i-this.force.z*o,0,this.force.z*i+this.force.x*o),this.force.length()>this.speed&&this.force.normalize().scale(this.speed)}this.entity.rigidbody.applyImpulse(this.force)};var Follow=pc.createScript("follow");Follow.attributes.add("target",{type:"entity",title:"Target",description:"The Entity to follow"}),Follow.attributes.add("distance",{type:"number",default:4,title:"Distance",description:"How far from the Entity should the follower be"}),Follow.prototype.initialize=function(){this.vec=new pc.Vec3},Follow.prototype.update=function(t){if(this.target){var e=this.target.getPosition();e.x+=.75*this.distance,e.y+=1*this.distance,e.z+=.75*this.distance,this.vec.lerp(this.vec,e,.1),this.entity.setPosition(this.vec)}};var Teleport=pc.createScript("teleport");Teleport.attributes.add("target",{type:"entity",title:"Target Entity",description:"The target entity where we are going to teleport"}),Teleport.prototype.initialize=function(){this.target&&this.entity.collision.on("triggerenter",this.onTriggerEnter,this)},Teleport.prototype.onTriggerEnter=function(t){t.script.teleportable&&t.script.teleportable.teleport(this.entity,this.target)};var Raycast=pc.createScript("raycast");Raycast.prototype.initialize=function(){this.firstPosition=new pc.Vec3(-1,1.25,6.5),this.secondPosition=new pc.Vec3(1,1.25,6.5),this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.mouseDown,this),this.app.touch&&this.app.touch.on(pc.EVENT_TOUCHSTART,this.touchStart,this)},Raycast.prototype.mouseDown=function(t){this.doRaycast(t)},Raycast.prototype.touchStart=function(t){1==t.touches.length&&this.doRaycast(t.touches[0]),t.event.preventDefault()},Raycast.prototype.doRaycast=function(t){var i=this.entity.getPosition(),s=this.entity.camera.screenToWorld(t.x,t.y,this.entity.camera.farClip),o=this.app.systems.rigidbody.raycastFirst(i,s);if(o){var e=o.entity;"1"==e.name?this.entity.script.lerp.targetPosition=this.firstPosition:"2"==e.name&&(this.entity.script.lerp.targetPosition=this.secondPosition)}};var Teleportable=pc.createScript("teleportable");Teleportable.prototype.initialize=function(){this.lastTeleportFrom=null,this.lastTeleportTo=null,this.lastTeleport=Date.now(),this.startPosition=this.entity.getPosition().clone()},Teleportable.prototype.update=function(t){this.entity.getPosition().y<0&&this.teleport(this.lastTeleportFrom,this.lastTeleportTo)},Teleportable.prototype.teleport=function(t,e){var o;t&&Date.now()-this.lastTeleport<500||(this.lastTeleport=Date.now(),this.lastTeleportFrom=t,this.lastTeleportTo=e,e?(o=e.getPosition()).y+=.5:o=this.startPosition,this.entity.rigidbody.teleport(o),this.entity.rigidbody.linearVelocity=pc.Vec3.ZERO,this.entity.rigidbody.angularVelocity=pc.Vec3.ZERO)};var TvScreen=pc.createScript("tvScreen");TvScreen.attributes.add("screenMaterial",{title:"Screen Material",description:"The screen material of the TV that displays the video texture.",type:"asset",assetType:"material"}),TvScreen.attributes.add("playEvent",{title:"Play Event",description:"Set the TV screen material emissive map on this event.",type:"string",default:""}),TvScreen.prototype.initialize=function(){this.app.on(this.playEvent,function(e){var t=this.screenMaterial.resource;t.emissiveMap=e,t.update()},this)};var UiManager=pc.createScript("uiManager");UiManager.attributes.add("playerEntity",{type:"entity",title:"FPS Script Entity",description:"FPS Script Entity"}),UiManager.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity",description:"Camera Entity"}),UiManager.attributes.add("stallScriptEntity",{type:"entity",title:"Stall Script Entity",description:"Stall Script Entity"}),UiManager.attributes.add("buttonEntity",{type:"entity",title:"Hide Screen Button",description:"Hide Button Object "}),UiManager.attributes.add("goToURL",{type:"entity",title:"Go To URL Button",description:"Go to URL buttton"}),UiManager.attributes.add("uiScreenEntity",{type:"entity",title:"Info Screen Object",description:"Info Screen on which there will be go to url option and a downloable PDF Link"}),UiManager.prototype.initialize=function(){this.app.on("HideScreen",this.hideCursorAndLock,this),this.app.on("UnlockCursor",this.showCursor,this)},UiManager.prototype.update=function(t){},UiManager.prototype.hideScreenBack=function(t){this.uiScreenEntity.enabled=!1,this.playerEntity.script.firstPersonMovement.allowLock=!0,this.app.mouse.enablePointerLock()},UiManager.prototype.GotoURL=function(t){this.app.root.findByName("Player").allowLock=!0,this.myEntity.allowLock=!0,this.app.mouse.enablePointerLock(),window.open("https://videotexture.herokuapp.com/videobrowser")},UiManager.prototype.hideCursorAndLock=function(t){this.playerEntity.script.firstPersonMovement.allowLock=!0,this.app.mouse.enablePointerLock()},UiManager.prototype.showCursor=function(t){this.playerEntity.script.firstPersonMovement.allowLock=!1,this.app.mouse.disablePointerLock()};var PointAndClick=pc.createScript("pointAndClick");PointAndClick.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),PointAndClick.attributes.add("playerEntity",{type:"entity",title:"Player Entity"}),PointAndClick.attributes.add("markerEntity",{type:"entity",title:"Marker Entity"}),PointAndClick.attributes.add("markerScript",{type:"entity",title:"Marker Script"}),PointAndClick.attributes.add("aimEntity",{type:"entity",title:"Aim Entity"}),PointAndClick.attributes.add("playerSpeed",{type:"number",default:0,title:"Player Speed"}),PointAndClick.attributes.add("allowPulse",{type:"boolean",default:!0,title:"Allow Pulse"}),PointAndClick.attributes.add("lntCanvasUI",{type:"entity",title:"LNT Canvas UI"}),PointAndClick.prototype.initialize=function(){this.groundShape=new pc.BoundingBox(new pc.Vec3(0,0,8),new pc.Vec3(50,.001,20)),this.direction=new pc.Vec3,this.distanceToTravel=0,this.targetPosition=new pc.Vec3,this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseDown,this),this.app.touch,this.validDistance=!0},PointAndClick.newPosition=new pc.Vec3,PointAndClick.prototype.update=function(t){},PointAndClick.prototype.onMouseDown=function(t){t.button==pc.MOUSEBUTTON_LEFT&&this.doRayCast()},PointAndClick.prototype.onTouchStart=function(t){1==t.touches.length&&(this.doRayCast(),t.event.preventDefault())},PointAndClick.ray=new pc.Ray,PointAndClick.hitPosition=new pc.Vec3,PointAndClick.prototype.doRayCast=function(){var t=PointAndClick.ray,i=PointAndClick.hitPosition,e=this.app.graphicsDevice.width/2,n=this.app.graphicsDevice.height/2,a=this.cameraEntity.camera.screenToWorld(e,n,this.cameraEntity.camera.nearClip),r=this.cameraEntity.camera.screenToWorld(e,n,this.cameraEntity.camera.farClip),o=this.markerScript;this.cameraEntity.camera.screenToWorld(e,n,this.cameraEntity.camera.farClip,t.direction),t.origin.copy(this.cameraEntity.getPosition()),t.direction.sub(t.origin).normalize();var s=this.app.systems.rigidbody.raycastFirst(a,r);if(console.log(this.validDistance),!s||o.script.marker.allowMove){if(this.validDistance){this.groundShape.intersectsRay(t,i);return this.cameraEntity.camera.fov=60,console.log("Player Position : ",this.playerEntity.getPosition()),console.log("Hit Position : ",i),void(this.entity.script.lerp.targetPosition=i)}}else{var c=s.entity;if(c.tags.has("Hotspot")&&this.aimEntity.enabled)this.markerEntity.enabled=!1,this.aimEntity.enabled=!0,console.log("Rotation camera : ",this.cameraEntity.getRotation()),c.script.pointTomarker?(this.entity.script.lerp.targetPosition=c.script.pointTomarker.markerEntity.getPosition(),this.playerEntity.setEulerAngles(c.script.pointTomarker.markerEntity.getLocalEulerAngles()),this.lntCanvasUI.enabled=!0):console.log("There is no PointTomarker script attached"),this.cameraEntity.setLocalEulerAngles(0,0,0),this.allowPulse=!1,this.cameraEntity.camera.fov=70,this.entity.script.marker.allowScanning=!1,this.markerEntity.enabled=!1,this.playerEntity.script.firstPersonMovement.eulers.x=0,this.playerEntity.script.firstPersonMovement.eulers.y=0;else{if(c.tags.has("Stall")||c.tags.has("RestrictedPlane"))return void console.log("Stall");if(c.tags.has("LNTExitButton")||c.tags.has("MercExitButton"))return this.markerEntity.enabled=!0,this.aimEntity.enabled=!0,this.cameraEntity.camera.fov=60,void(this.entity.script.marker.allowScanning=!0);this.allowPulse=!0}}};var VideoTexture=pc.createScript("videoTextureOffline");VideoTexture.attributes.add("video",{title:"Video",description:"MP4 video asset to play back on this video texture.",type:"asset"}),VideoTexture.attributes.add("playEvent",{title:"Play Event",description:"Event that is fired as soon as the video texture is ready to play.",type:"string",default:""}),VideoTexture.prototype.initialize=function(){var e=this.app,t=document.createElement("video");t.autoplay=!0,t.crossOrigin="anonymous",t.loop=!0,t.muted=!0,t.playsInline=!0,t.src=this.video.getFileUrl();var i=t.style;i.width="1px",i.height="1px",i.position="absolute",i.opacity="0",i.zIndex="-1000",i.pointerEvents="none",document.body.appendChild(t),this.videoTexture=new pc.Texture(e.graphicsDevice,{format:pc.PIXELFORMAT_R8_G8_B8,minFilter:pc.FILTER_LINEAR_MIPMAP_LINEAR,magFilter:pc.FILTER_LINEAR,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE,mipmaps:!0,autoMipmap:!0}),this.videoTexture.setSource(t),t.addEventListener("canplay",function(t){e.fire(this.playEvent,this.videoTexture)}.bind(this))},VideoTexture.prototype.update=function(e){this.videoTexture.upload()};var Hotspot=pc.createScript("hotspot");Hotspot.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),Hotspot.attributes.add("cursorEntity",{type:"entity",title:"Camera Entity"}),Hotspot.attributes.add("entityToTurnOn",{type:"entity",title:"Turn On This Entity"}),Hotspot.attributes.add("elementToTurnOn",{type:"entity",title:"Turn On This Element"}),Hotspot.attributes.add("radius",{type:"number",title:"Radius"}),Hotspot.attributes.add("fadeDropOff",{type:"number",default:.4,title:"Fade Drop Off",description:"When to start fading out hotspot relative to the camera direction. 1 for when hotspot is directly inline with the camera. 0 for never."}),Hotspot.prototype.initialize=function(){this.myEntity=this.app.root.findByName("Player"),this.myEntity.allowLock,this.hitArea=new pc.BoundingSphere(this.entity.getPosition(),this.radius),this.ray=new pc.Ray,this.defaultForwardDirection=this.entity.forward.clone(),this.directionToCamera=new pc.Vec3,this.sprite=this.entity.children[0],this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseDown,this),this.app.touch&&this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStart,this)},Hotspot.prototype.update=function(t){var e=this.cameraEntity.getPosition();this.directionToCamera.sub2(e,this.entity.getPosition()),this.directionToCamera.normalize();var i=this.directionToCamera.dot(this.defaultForwardDirection);if(i<0)this.sprite.enabled;else{this.sprite.enabled||(this.sprite.enabled=!0);for(var o=this.sprite.model.meshInstances,n=pc.math.clamp(i/this.fadeDropOff,0,1),s=0;s<o.length;++s)o[s].setParameter("material_opacity",n)}this.doRayCast(event)},Hotspot.prototype.doRayCast=function(t){if(this.sprite.enabled){var e=this.app.graphicsDevice.width/2,i=this.app.graphicsDevice.height/2;this.cameraEntity.camera.screenToWorld(e,i,this.cameraEntity.camera.farClip,this.ray.direction),this.ray.origin.copy(this.cameraEntity.getPosition()),this.ray.direction.sub(this.ray.origin).normalize(),this.hitArea.intersectsRay(this.ray)?this.cursorEntity.enabled=!0:this.cursorEntity.enabled=!1}},Hotspot.prototype.onMouseDown=function(t){t.button==pc.MOUSEBUTTON_LEFT&&this.hitArea.intersectsRay(this.ray)&&(this.entity.fire("pulse:start"),this.app.mouse.disablePointerLock(),this.app.root.findByName("Player").allowLock=!1,this.entityToTurnOn&&(this.entityToTurnOn.enabled=!0),this.elementToTurnOn&&(this.elementToTurnOn.enabled=!0))},Hotspot.prototype.onTouchStart=function(t){t.event.preventDefault(),this.hitArea.intersectsRay(this.ray)&&(this.entity.fire("pulse:start"),this.app.mouse.disablePointerLock(),this.app.root.findByName("Player").allowLock=!1,this.entityToTurnOn&&(this.entityToTurnOn.enabled=!0),this.elementToTurnOn&&(this.elementToTurnOn.enabled=!0)),t.touches.length};var MouseInput=pc.createScript("mouseInput");MouseInput.attributes.add("orbitSensitivity",{type:"number",default:.3,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),MouseInput.attributes.add("distanceSensitivity",{type:"number",default:.15,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),MouseInput.prototype.initialize=function(){if(this.orbitCamera=this.entity.script.orbitCamera,this.orbitCamera){var t=this,o=function(o){t.onMouseOut(o)};this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.addEventListener("mouseout",o,!1),this.on("destroy",function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.removeEventListener("mouseout",o,!1)})}this.app.mouse.disableContextMenu(),this.lookButtonDown=!1,this.panButtonDown=!1,this.lastPoint=new pc.Vec2},MouseInput.fromWorldPoint=new pc.Vec3,MouseInput.toWorldPoint=new pc.Vec3,MouseInput.worldDiff=new pc.Vec3,MouseInput.prototype.pan=function(t){var o=MouseInput.fromWorldPoint,e=MouseInput.toWorldPoint,i=MouseInput.worldDiff,s=this.entity.camera,n=this.orbitCamera.distance;s.screenToWorld(t.x,t.y,n,o),s.screenToWorld(this.lastPoint.x,this.lastPoint.y,n,e),i.sub2(e,o),this.orbitCamera.pivotPoint.add(i)},MouseInput.prototype.onMouseDown=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!0;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!0}},MouseInput.prototype.onMouseUp=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!1;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!1}},MouseInput.prototype.onMouseMove=function(t){pc.app.mouse;this.lookButtonDown?(this.orbitCamera.pitch-=t.dy*this.orbitSensitivity,this.orbitCamera.yaw-=t.dx*this.orbitSensitivity):this.panButtonDown&&this.pan(t),this.lastPoint.set(t.x,t.y)},MouseInput.prototype.onMouseWheel=function(t){this.orbitCamera.distance-=t.wheel*this.distanceSensitivity*(.1*this.orbitCamera.distance),t.event.preventDefault()},MouseInput.prototype.onMouseOut=function(t){this.lookButtonDown=!1,this.panButtonDown=!1};var TouchInput=pc.createScript("touchInput");TouchInput.attributes.add("orbitSensitivity",{type:"number",default:.4,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),TouchInput.attributes.add("distanceSensitivity",{type:"number",default:.2,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),TouchInput.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera,this.lastTouchPoint=new pc.Vec2,this.lastPinchMidPoint=new pc.Vec2,this.lastPinchDistance=0,this.orbitCamera&&this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.on("destroy",function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)}))},TouchInput.prototype.getPinchDistance=function(t,i){var o=t.x-i.x,n=t.y-i.y;return Math.sqrt(o*o+n*n)},TouchInput.prototype.calcMidPoint=function(t,i,o){o.set(i.x-t.x,i.y-t.y),o.scale(.5),o.x+=t.x,o.y+=t.y},TouchInput.prototype.onTouchStartEndCancel=function(t){var i=t.touches;1==i.length?this.lastTouchPoint.set(i[0].x,i[0].y):2==i.length&&(this.lastPinchDistance=this.getPinchDistance(i[0],i[1]),this.calcMidPoint(i[0],i[1],this.lastPinchMidPoint))},TouchInput.fromWorldPoint=new pc.Vec3,TouchInput.toWorldPoint=new pc.Vec3,TouchInput.worldDiff=new pc.Vec3,TouchInput.prototype.pan=function(t){var i=TouchInput.fromWorldPoint,o=TouchInput.toWorldPoint,n=TouchInput.worldDiff,h=this.entity.camera,c=this.orbitCamera.distance;h.screenToWorld(t.x,t.y,c,i),h.screenToWorld(this.lastPinchMidPoint.x,this.lastPinchMidPoint.y,c,o),n.sub2(o,i),this.orbitCamera.pivotPoint.add(n)},TouchInput.pinchMidPoint=new pc.Vec2,TouchInput.prototype.onTouchMove=function(t){var i=TouchInput.pinchMidPoint,o=t.touches;if(1==o.length){var n=o[0];this.orbitCamera.pitch-=(n.y-this.lastTouchPoint.y)*this.orbitSensitivity,this.orbitCamera.yaw-=(n.x-this.lastTouchPoint.x)*this.orbitSensitivity,this.lastTouchPoint.set(n.x,n.y)}else if(2==o.length){var h=this.getPinchDistance(o[0],o[1]),c=h-this.lastPinchDistance;this.lastPinchDistance=h,this.orbitCamera.distance-=c*this.distanceSensitivity*.1*(.1*this.orbitCamera.distance),this.calcMidPoint(o[0],o[1],i),this.pan(i),this.lastPinchMidPoint.copy(i)}};var PulseLoop=pc.createScript("pulseLoop");PulseLoop.attributes.add("pulseTimeSecs",{type:"number",default:2,title:"Pulse Time Secs"}),PulseLoop.prototype.initialize=function(){this.secsSinceStart=this.pulseTimeSecs+1,this.entity.on("pulse:start",this.onStartEvent,this)},PulseLoop.prototype.update=function(t){if(this.secsSinceStart+=t,this.secsSinceStart<=this.pulseTimeSecs){var e=this.secsSinceStart/this.pulseTimeSecs,s=.3*(2*Math.abs(e-.5))+.7,i=this.entity.getLocalScale();i.set(s,s,s),this.entity.setLocalScale(i)}else this.secsSinceStart=0},PulseLoop.prototype.onStartEvent=function(){this.secsSinceStart=0};var OrbitCamera=pc.createScript("orbitCamera");OrbitCamera.attributes.add("distanceMax",{type:"number",default:0,title:"Distance Max",description:"Setting this at 0 will give an infinite distance limit"}),OrbitCamera.attributes.add("distanceMin",{type:"number",default:0,title:"Distance Min"}),OrbitCamera.attributes.add("pitchAngleMax",{type:"number",default:90,title:"Pitch Angle Max (degrees)"}),OrbitCamera.attributes.add("pitchAngleMin",{type:"number",default:-90,title:"Pitch Angle Min (degrees)"}),OrbitCamera.attributes.add("inertiaFactor",{type:"number",default:0,title:"Inertia Factor",description:"Higher value means that the camera will continue moving after the user has stopped dragging. 0 is fully responsive."}),OrbitCamera.attributes.add("focusEntity",{type:"entity",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("frameOnStart",{type:"boolean",default:!0,title:"Frame on Start",description:'Frames the entity or scene at the start of the application."'}),Object.defineProperty(OrbitCamera.prototype,"distance",{get:function(){return this._targetDistance},set:function(t){this._targetDistance=this._clampDistance(t)}}),Object.defineProperty(OrbitCamera.prototype,"pitch",{get:function(){return this._targetPitch},set:function(t){this._targetPitch=this._clampPitchAngle(t)}}),Object.defineProperty(OrbitCamera.prototype,"yaw",{get:function(){return this._targetYaw},set:function(t){this._targetYaw=t;var i=(this._targetYaw-this._yaw)%360;this._targetYaw=i>180?this._yaw-(360-i):i<-180?this._yaw+(360+i):this._yaw+i}}),Object.defineProperty(OrbitCamera.prototype,"pivotPoint",{get:function(){return this._pivotPoint},set:function(t){this._pivotPoint.copy(t)}}),OrbitCamera.prototype.focus=function(t){this._buildAabb(t,0);var i=this._modelsAabb.halfExtents,e=Math.max(i.x,Math.max(i.y,i.z));e/=Math.tan(.5*this.entity.camera.fov*pc.math.DEG_TO_RAD),e*=2,this.distance=e,this._removeInertia(),this._pivotPoint.copy(this._modelsAabb.center)},OrbitCamera.distanceBetween=new pc.Vec3,OrbitCamera.prototype.resetAndLookAtPoint=function(t,i){this.pivotPoint.copy(i),this.entity.setPosition(t),this.entity.lookAt(i);var e=OrbitCamera.distanceBetween;e.sub2(i,t),this.distance=e.length(),this.pivotPoint.copy(i);var a=this.entity.getRotation();this.yaw=this._calcYaw(a),this.pitch=this._calcPitch(a,this.yaw),this._removeInertia(),this._updatePosition()},OrbitCamera.prototype.resetAndLookAtEntity=function(t,i){this._buildAabb(i,0),this.resetAndLookAtPoint(t,this._modelsAabb.center)},OrbitCamera.prototype.reset=function(t,i,e){this.pitch=i,this.yaw=t,this.distance=e,this._removeInertia()},OrbitCamera.prototype.initialize=function(){var t=this,i=function(){t._checkAspectRatio()};window.addEventListener("resize",i,!1),this._checkAspectRatio(),this._modelsAabb=new pc.BoundingBox,this._buildAabb(this.focusEntity||this.app.root,0),this.entity.lookAt(this._modelsAabb.center),this._pivotPoint=new pc.Vec3,this._pivotPoint.copy(this._modelsAabb.center);var e=this.entity.getRotation();if(this._yaw=this._calcYaw(e),this._pitch=this._clampPitchAngle(this._calcPitch(e,this._yaw)),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0),this._distance=0,this._targetYaw=this._yaw,this._targetPitch=this._pitch,this.frameOnStart)this.focus(this.focusEntity||this.app.root);else{var a=new pc.Vec3;a.sub2(this.entity.getPosition(),this._pivotPoint),this._distance=this._clampDistance(a.length())}this._targetDistance=this._distance,this.on("attr:distanceMin",function(t,i){this._targetDistance=this._clampDistance(this._distance)}),this.on("attr:distanceMax",function(t,i){this._targetDistance=this._clampDistance(this._distance)}),this.on("attr:pitchAngleMin",function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)}),this.on("attr:pitchAngleMax",function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)}),this.on("attr:focusEntity",function(t,i){this.frameOnStart?this.focus(t||this.app.root):this.resetAndLookAtEntity(this.entity.getPosition(),t||this.app.root)}),this.on("attr:frameOnStart",function(t,i){t&&this.focus(this.focusEntity||this.app.root)}),this.on("destroy",function(){window.removeEventListener("resize",i,!1)})},OrbitCamera.prototype.update=function(t){var i=0===this.inertiaFactor?1:Math.min(t/this.inertiaFactor,1);this._distance=pc.math.lerp(this._distance,this._targetDistance,i),this._yaw=pc.math.lerp(this._yaw,this._targetYaw,i),this._pitch=pc.math.lerp(this._pitch,this._targetPitch,i),this._updatePosition()},OrbitCamera.prototype._updatePosition=function(){this.entity.setLocalPosition(0,0,0),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0);var t=this.entity.getPosition();t.copy(this.entity.forward),t.scale(-this._distance),t.add(this.pivotPoint),this.entity.setPosition(t)},OrbitCamera.prototype._removeInertia=function(){this._yaw=this._targetYaw,this._pitch=this._targetPitch,this._distance=this._targetDistance},OrbitCamera.prototype._checkAspectRatio=function(){var t=this.app.graphicsDevice.height,i=this.app.graphicsDevice.width;this.entity.camera.horizontalFov=t>i},OrbitCamera.prototype._buildAabb=function(t,i){var e=0;if(t.model){var a=t.model.meshInstances;for(e=0;e<a.length;e++)0===i?this._modelsAabb.copy(a[e].aabb):this._modelsAabb.add(a[e].aabb),i+=1}for(e=0;e<t.children.length;++e)i+=this._buildAabb(t.children[e],i);return i},OrbitCamera.prototype._calcYaw=function(t){var i=new pc.Vec3;return t.transformVector(pc.Vec3.FORWARD,i),Math.atan2(-i.x,-i.z)*pc.math.RAD_TO_DEG},OrbitCamera.prototype._clampDistance=function(t){return this.distanceMax>0?pc.math.clamp(t,this.distanceMin,this.distanceMax):Math.max(t,this.distanceMin)},OrbitCamera.prototype._clampPitchAngle=function(t){return pc.math.clamp(t,-this.pitchAngleMax,-this.pitchAngleMin)},OrbitCamera.quatWithoutYaw=new pc.Quat,OrbitCamera.yawOffset=new pc.Quat,OrbitCamera.prototype._calcPitch=function(t,i){var e=OrbitCamera.quatWithoutYaw,a=OrbitCamera.yawOffset;a.setFromEulerAngles(0,-i,0),e.mul2(a,t);var s=new pc.Vec3;return e.transformVector(pc.Vec3.FORWARD,s),Math.atan2(s.y,-s.z)*pc.math.RAD_TO_DEG};var DetectLongPress=pc.createScript("detectLongPress");DetectLongPress.attributes.add("detectionTime",{type:"number",default:0,title:"Detection Time Secs",description:"The time to press before a long press is detected"}),DetectLongPress.attributes.add("materialAssetList",{type:"asset",assetType:"material",title:"Material Asset List",array:!0}),DetectLongPress.prototype.initialize=function(){this.app.mouse&&(this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this)),this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchEndCancel,this)),this.timeSincePressed=0,this.pressed=!1},DetectLongPress.prototype.update=function(t){var e=this.timeSincePressed;this.timeSincePressed+=t,this.pressed?e<this.detectionTime&&(this.timeSincePressed,this.detectionTime):this.timeSincePressed=0},DetectLongPress.prototype.onLongPress=function(){this.materialIndex=(this.materialIndex+1)%this.materialAssetList.length;for(var t=this.entity.model.meshInstances,e=0;e<t.length;++e){t[e].material=this.materialAssetList[this.materialIndex].resource}},DetectLongPress.prototype.onMouseDown=function(t){t.button==pc.MOUSEBUTTON_LEFT&&(this.pressed=!0)},DetectLongPress.prototype.onMouseUp=function(t){t.button==pc.MOUSEBUTTON_LEFT&&(this.pressed=!1)},DetectLongPress.prototype.onTouchStart=function(t){1==t.touches.length&&(this.pressed=!0)},DetectLongPress.prototype.onTouchEndCancel=function(t){0===t.touches.length&&(this.pressed=!1)};var DetectDoubleTap=pc.createScript("detectDoubleTap");DetectDoubleTap.attributes.add("cameraEntity",{type:"entity",title:"CameraEntity"}),DetectDoubleTap.attributes.add("doubleTapSpeed",{type:"number",default:.5,title:"Double Tap Speed",description:"The maximum time (secs) allowed between tap to register as a double tap"}),DetectDoubleTap.prototype.initialize=function(){this.timeSinceLastTap=this.doubleTapSpeed,this.app.touch&&this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this)},DetectDoubleTap.prototype.update=function(t){this.timeSinceLastTap+=t},DetectDoubleTap.prototype.onTouchStart=function(t){t.touches.length>1||(this.timeSinceLastTap<this.doubleTapSpeed?(this.onDoubleTap(),this.timeSinceLastTap=this.doubleTapSpeed):this.timeSinceLastTap=0)},DetectDoubleTap.prototype.onDoubleTap=function(){};var BtnStates=pc.createScript("buttonStates");BtnStates.attributes.add("hoverAsset",{type:"asset",assetType:"texture"}),BtnStates.attributes.add("activeAsset",{type:"asset",assetType:"texture"}),BtnStates.prototype.initialize=function(){this.originalTexture=this.entity.element.textureAsset,this.hovered=!1,this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mousedown",this.onPress,this),this.entity.element.on("mouseup",this.onRelease,this),this.entity.element.on("mouseleave",this.onLeave,this),this.entity.element.on("touchstart",this.onPress,this),this.entity.element.on("touchend",this.onRelease,this)},BtnStates.prototype.onEnter=function(t){this.hovered=!0,t.element.textureAsset=this.hoverAsset,document.body.style.cursor="pointer"},BtnStates.prototype.onLeave=function(t){this.hovered=!1,t.element.textureAsset=this.originalTexture,document.body.style.cursor="default"},BtnStates.prototype.onPress=function(t){t.element.textureAsset=this.activeAsset},BtnStates.prototype.onRelease=function(t){t.element.textureAsset=this.hovered?this.hoverAsset:this.originalTexture};var Rotate=pc.createScript("rotate");Rotate.prototype.initialize=function(){},Rotate.prototype.onRotationEvent=function(t){this.entity.rotate(0,10*t,0)};var ScrollingTexture=pc.createScript("scrollingTexture");ScrollingTexture.attributes.add("materialAsset",{type:"asset"}),ScrollingTexture.attributes.add("speed",{type:"vec2"}),ScrollingTexture.tmp=new pc.Vec2,ScrollingTexture.prototype.initialize=function(){this.materialAsset&&(this.material=this.materialAsset.resource)},ScrollingTexture.prototype.update=function(e){var t=ScrollingTexture.tmp;t.set(this.speed.x,this.speed.y),t.scale(e),this.material.diffuseMapOffset=this.material.diffuseMapOffset.add(t),this.material.normalMapOffset.add(t),this.material.update(),console.log("Material update")};var AnimatedTexture=pc.createScript("animatedTexture");AnimatedTexture.attributes.add("materialAsset",{type:"asset",assetType:"material"}),AnimatedTexture.attributes.add("numFrames",{type:"number",default:1,description:"Number of frames to play before looping"}),AnimatedTexture.attributes.add("startFrame",{type:"number",default:0,description:"Frame to start animation from"}),AnimatedTexture.attributes.add("width",{type:"number",default:1,description:"Number of frames wide"}),AnimatedTexture.attributes.add("height",{type:"number",default:1,description:"Number of frames high"}),AnimatedTexture.attributes.add("frameRate",{type:"number",default:1,description:"Playback frames per second"}),AnimatedTexture.prototype.initialize=function(){this.materialAsset&&(this.material=this.materialAsset.resource),this.timer=1/this.frameRate,this.frame=this.startFrame,this.transform=new pc.Vec4,this.updateMaterial(this.frame)},AnimatedTexture.prototype.update=function(t){this.timer-=t,this.timer<0&&(this.frame++,this.frame>=this.numFrames+this.startFrame&&(this.frame=this.startFrame),this.updateMaterial(this.frame),this.timer=1/this.frameRate)},AnimatedTexture.prototype.updateMaterial=function(t){var e=1/this.width,a=1/this.height,r=t%this.width,i=Math.floor(t/this.width),s=this.entity.model.meshInstances;this.transform.set(e,a,r*e,1-a-i*a),s[0].setParameter("texture_diffuseMapTransform",this.transform.data),s[0].setParameter("texture_emissiveMapTransform",this.transform.data),s[0].setParameter("texture_opacityMapTransform",this.transform.data)};var TriggerDesk=pc.createScript("triggerDesk");TriggerDesk.attributes.add("playerEntity",{type:"entity",title:"Camera Entity"}),TriggerDesk.attributes.add("turnOnEntity",{type:"entity",title:"Turn On This Entity"}),TriggerDesk.attributes.add("distance",{type:"number",title:"Distance to Consider"}),TriggerDesk.attributes.add("isOn",{type:"boolean",title:"Bool to indictate status"}),TriggerDesk.prototype.initialize=function(){},TriggerDesk.prototype.update=function(t){var i=this.playerEntity.getPosition().distance(this.entity.getPosition());i<this.distance&&!1===this.isOn?(this.isOn=!0,this.turnOnEntity.enabled=!0,this.app.mouse.disablePointerLock()):i>this.distance&&(this.isOn=!1,this.turnOnEntity.enabled=!1)};var CssHandler=pc.createScript("cssHandler");CssHandler.attributes.add("css",{type:"asset",assetType:"css",title:"CSS Asset"}),CssHandler.prototype.initialize=function(){this.element=document.createElement("style"),document.head.appendChild(this.element),this.asset=null,this.assetId=0},CssHandler.prototype.attachAsset=function(s,t){if(this.assetId=s,!this.assetId)return t.call(this);var e=this.app.assets.get(this.assetId),a=this;e._onLoad=function(s){t.call(a,s,s.resource)},e.on("load",e._onLoad),t.call(this,e,e.resource),this.app.assets.load(e)},CssHandler.prototype.template=function(s,t){this.asset&&this.asset!==s&&this.asset.off("load",this.asset._onLoad),this.asset=s,this.element.innerHTML=t||""},CssHandler.prototype.update=function(s){this.assetId!==this.css.id&&this.attachAsset(this.css.id,this.template)};var HtmlHandler=pc.createScript("htmlHandler");HtmlHandler.attributes.add("html",{type:"asset",assetType:"html",title:"HTML Asset"}),HtmlHandler.attributes.add("playerEntity",{type:"entity",title:"FPS Player Script"}),HtmlHandler.prototype.initialize=function(){var e=document.createElement("link");e.rel="stylesheet",e.href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css",document.body.appendChild(e);var t=document.createElement("link");t.rel="stylesheet",t.href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css",document.body.appendChild(t);var s=document.createElement("script");s.src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js",document.body.appendChild(s);var i=document.createElement("script");s.src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js",document.body.appendChild(i),this.element=document.createElement("div"),this.element.classList.add("modal"),this.element.classList.add("fade"),this.element.setAttribute("id","myModal"),this.element.setAttribute("role","myModal"),document.body.appendChild(this.element),this.elementModal=document.createElement("div"),this.elementModal.classList.add("modal"),this.elementModal.classList.add("fade"),this.elementModal.setAttribute("id","Modal2"),this.elementModal.setAttribute("role","Modal2"),this.elementModal.innerHTML='<div class="modal-dialog videomodal"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" id="close_modal2" data-dismiss="modal">&times;</button> <h4 class="modal-title">Video Call</h4> </div> <iframe id="videoCallFrame"  src="" width="100%" height="600px" scrolling="no" allow="microphone; camera" ></iframe> <div class="modal-footer"> <button type="button" id="close_bottom_modal2" class="btn btn-default closeButton" data-dismiss="modal">Close</button> </div></div></div>',document.body.appendChild(this.elementModal),this.asset=null,this.assetId=0,this.counter=0},HtmlHandler.prototype.attachAsset=function(e,t){if(this.assetId=e,!this.assetId)return t.call(this);var s=this.app.assets.get(this.assetId),i=this;s._onLoad=function(e){t.call(i,e,e.resource)},s.on("load",s._onLoad),t.call(this,s,s.resource),this.app.assets.load(s)},HtmlHandler.prototype.template=function(e,t){this.asset&&this.asset!==e&&this.asset.off("load",this.asset._onLoad),this.asset=e,this.element.innerHTML=t||"",t&&this.bindEvents()},HtmlHandler.prototype.bindEvents=function(){var e=this.element.querySelector(".closeButton"),t=this.element.querySelector(".close"),s=document.getElementById("close_modal2"),i=document.getElementById("close_bottom_modal2"),a=document.getElementById("videoCallFrame"),l=this.element.querySelector(".pdfli"),n=this.element.querySelector(".imageli"),d=this.element.querySelector(".videoli"),o=document.getElementById("pdfli"),c=document.getElementById("imageli"),m=document.getElementById("videoli"),r=document.getElementById("elementpdfliactive"),p=document.getElementById("elementimageliactive"),u=document.getElementById("elementvideoliactive"),v=document.getElementById("videplay"),h=document.getElementsByClassName("modal"),y=document.getElementById("Modal2");s&&s.addEventListener("click",function(){pc.app.fire("HideScreen"),a.src="",y.classList.remove("in","animated","slideInDown"),console.log("modal closing")},!1),i&&i.addEventListener("click",function(){pc.app.fire("HideScreen"),a.src="",y.classList.remove("in","animated","slideInDown"),console.log("modal closing")},!1),e&&e.addEventListener("click",function(){pc.app.fire("HideScreen"),h[0].classList.remove("in","animated","slideInDown"),v.pause()},!1),t&&t.addEventListener("click",function(){h[0].classList.remove("in","animated","slideInDown"),v.pause(),pc.app.fire("HideScreen")},!1),l&&l.addEventListener("click",function(){r.classList.add("active"),p.classList.remove("active"),u.classList.remove("active"),o.classList.add("in","active"),m.classList.remove("in","active"),c.classList.remove("in","active"),v.pause()},!1),l.click(),n&&n.addEventListener("click",function(){r.classList.remove("active"),p.classList.add("active"),u.classList.remove("active"),o.classList.remove("in","active"),m.classList.remove("in","active"),c.classList.add("in","active"),v.pause()},!1),d&&d.addEventListener("click",function(){r.classList.remove("active"),p.classList.remove("active"),u.classList.add("active"),o.classList.remove("in","active"),m.classList.add("in","active"),c.classList.remove("in","active"),v.play()},!1),s&&(console.log("Close button modal 2"),s.addEventListener("click",function(){h[1].classList.remove("in","animated","slideInDown")},!1))},HtmlHandler.prototype.allowLock=function(){this.uiManagerEntity.script.uiManager.hideScreenBack()},HtmlHandler.prototype.update=function(e){this.assetId!==this.html.id&&this.attachAsset(this.html.id,this.template)};var Box=pc.createScript("box");Box.attributes.add("html",{type:"asset",assetType:"html",title:"HTML Asset"}),Box.attributes.add("playerEntity",{type:"entity",title:"FPS Script Entity"}),Box.prototype.initialize=function(){this.iframesrc="https://tokbox.com/embed/embed/ot-embed.js?embedId=a122f89f-4552-4e54-a807-37fdbd6c1495&room=DEFAULT_ROOM&iframe=true",this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.touch},Box.prototype.update=function(t){this.app.keyboard.isPressed(pc.KEY_RETURN)&&(document.getElementById("myModal").classList.add("in","animated","slideInDown"),this.app.mouse.disablePointerLock(),this.playerEntity.script.firstPersonMovement.allowLock=!1);if(this.app.keyboard.isPressed(pc.KEY_M)){document.getElementById("Modal2").classList.add("in","animated","slideInDown");var e=document.getElementById("videoCallFrame");console.log(this.iframesrc),e.src=this.iframesrc,this.app.mouse.disablePointerLock(),this.playerEntity.script.firstPersonMovement.allowLock=!1}},Box.prototype.onMouseDown=function(t){},Box.prototype.onTouchStart=function(t){1==t.touches.length&&document.getElementsByClassName("modal")[0].classList.add("in","animated","slideInDown")};var uni_video,Videotexture=pc.createScript("videoTextureOnline");Videotexture.attributes.add("materials",{type:"asset",assetType:"material",array:!0}),Videotexture.attributes.add("videoUrl",{type:"string"}),Videotexture.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity",description:"Camera Entity"}),Videotexture.prototype.initialize=function(){this.play1=!0,this.play2=!0,this.mute1=!0,this.mute2=!0,this.app.on("PlayPause",this.showCursor,this);var t=this.app,e=new pc.Texture(t.graphicsDevice,{format:pc.PIXELFORMAT_R5_G6_B5,autoMipmap:!1});e.minFilter=pc.FILTER_LINEAR,e.magFilter=pc.FILTER_LINEAR,e.addressU=pc.ADDRESS_CLAMP_TO_EDGE,e.addressV=pc.ADDRESS_CLAMP_TO_EDGE;var i=document.createElement("video");uni_video=i,console.log("Uni video :",uni_video),i.addEventListener("canplay",function(t){e.setSource(i)}),i.src=this.videoUrl,i.crossOrigin="anonymous",i.loop=!0,i.muted=!0,i.play(),i.controls=!0;for(var o=0;o<this.materials.length;o++){var s=this.materials[o].resource;s.emissiveMap=e,s.update()}this.videoTexture=e,this.upload=!0},Videotexture.prototype.onPlayorMute=function(t){var e=this.app.graphicsDevice.width/2,i=this.app.graphicsDevice.height/2,o=this.cameraEntity.camera.screenToWorld(e,i,this.cameraEntity.camera.nearClip),s=this.cameraEntity.camera.screenToWorld(e,i,this.cameraEntity.camera.farClip);this.app.systems.rigidbody.raycastFirst(o,s,function(t){var e=t.entity;e.tags.has("VideoPlayPauseButton1")?(this.play1=!this.play1,this.play1?(console.log("Play, ",this.play1),uni_video.play()):(console.log("Paused, ",this.play1),uni_video.pause()),e.script.pulseSingle):e.tags.has("VideoPlayPauseButton2")?(this.play2=!this.play2,this.play2?(console.log("Play, ",this.play2),uni_video.play()):(console.log("Paused, ",this.play2),uni_video.pause()),e.script.pulseSingle):e.tags.has("VideoMuteUnmuteButton1")?(this.mute1=!this.mute1,this.mute1?(console.log("Muted, ",this.mute1),uni_video.muted=this.mute):(console.log("Unmuted, ",this.mute1),uni_video.muted=this.mute)):e.tags.has("VideoMuteUnmuteButton2")&&(this.mute2=!this.mute2,this.mute2?(console.log("Muted, ",this.mute2),uni_video.muted=this.mute):(console.log("Unmuted, ",this.mute2),uni_video.muted=this.mute))})},Videotexture.prototype.playPause=function(){this.play=!this.play,this.play?(console.log("Play, ",this.play),console.log(uni_video),uni_video.play()):(console.log("Paused, ",this.play),console.log(uni_video),uni_video.pause())},Videotexture.prototype.muteUnmute=function(){this.mute=!this.mute,this.mute?(console.log("Muted, ",this.mute),console.log(uni_video),uni_video.muted=this.mute):!1===this.mute&&(console.log("Unmuted, ",this.mute),console.log(uni_video),uni_video.muted=this.mute)},Videotexture.prototype.update=function(t){this.upload=!this.upload,this.upload&&this.videoTexture.upload()};var Turn=pc.createScript("turn");Turn.prototype.update=function(t){this.entity.rotate(0,90*t,0)};var CameraPath=pc.createScript("cameraPath");CameraPath.attributes.add("pathRoot",{type:"entity",title:"Path Root"}),CameraPath.attributes.add("duration",{type:"number",default:10,title:"Duration Secs"}),CameraPath.attributes.add("startTime",{type:"number",default:0,title:"Start Time (Secs)",description:"Start the path from a specific point in time"}),CameraPath.attributes.add("allowMove",{type:"boolean",default:0,title:"Whether to allow move",description:"Whether to allow move"}),CameraPath.prototype.initialize=function(){this.createPath(),this.on("attr:pathRoot",function(t,i){t&&(this.createPath(),this.time=0)}),this.on("attr:time",function(t,i){this.time=pc.math.clamp(this.startTime,0,this.duration)}),this.time=pc.math.clamp(this.startTime,0,this.duration),this.lookAt=new pc.Vec3,this.up=new pc.Vec3},CameraPath.prototype.update=function(t){this.allowMove&&(this.time+=t),this.time>this.duration&&(this.time-=this.duration);var i=this.time/this.duration;this.entity.setPosition(this.px.value(i),this.py.value(i),this.pz.value(i)),this.lookAt.set(this.tx.value(i),this.ty.value(i),this.tz.value(i)),this.up.set(this.ux.value(i),this.uy.value(i),this.uz.value(i)),this.entity.lookAt(this.lookAt,this.up),this.app.keyboard.isPressed(pc.KEY_R)&&this.resetPosition()},CameraPath.prototype.resetPosition=function(t){this.allowMove=!this.allowMove,this.time=this.duration,this.entity.setPosition(0,1,0),console.log("ALlow lock")},CameraPath.prototype.createPath=function(){var t=pc.CURVE_CARDINAL;this.px=new pc.Curve,this.px.type=t,this.py=new pc.Curve,this.py.type=t,this.pz=new pc.Curve,this.pz.type=t,this.tx=new pc.Curve,this.tx.type=t,this.ty=new pc.Curve,this.ty.type=t,this.tz=new pc.Curve,this.tz.type=t,this.ux=new pc.Curve,this.ux.type=t,this.uy=new pc.Curve,this.uy.type=t,this.uz=new pc.Curve,this.uz.type=t;var e=this.pathRoot.children,a=0,s=[],h=new pc.Vec3;for(s.push(0),i=1;i<e.length;i++){var o=e[i-1],r=e[i];h.sub2(o.getPosition(),r.getPosition()),a+=h.length(),s.push(a)}for(i=0;i<e.length;i++){var p=s[i]/a,u=e[i],n=u.getPosition();this.px.add(p,n.x),this.py.add(p,n.y),this.pz.add(p,n.z);var d=n.clone().add(u.forward);this.tx.add(p,d.x),this.ty.add(p,d.y),this.tz.add(p,d.z);var l=u.up;this.ux.add(p,l.x),this.uy.add(p,l.y),this.uz.add(p,l.z)}};var HideScreenListener=pc.createScript("hideScreenListener");HideScreenListener.attributes.add("buttonEntity",{type:"entity",title:"Hide Screen Button",description:"Hide Button Object "}),HideScreenListener.attributes.add("uiScreenEntity",{type:"entity",title:"Info Screen Object",description:"Info Screen on which there will be go to url option and a downloable PDF Link"}),HideScreenListener.prototype.initialize=function(){this.buttonEntity.element.on("click",function(e){this.hideScreenBack()},this)},HideScreenListener.prototype.hideScreenBack=function(e){this.uiScreenEntity.enabled=!1,pc.app.fire("HideScreen")},HideScreenListener.prototype.update=function(e){};var PickerRaycast=pc.createScript("openModalRaycast");PickerRaycast.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity",description:"Camera Entity"}),PickerRaycast.attributes.add("lerpEntity",{type:"entity",title:"Lerp Entity",description:"Lerp Entity"}),PickerRaycast.attributes.add("markerEntity",{type:"entity",title:"Marker Entity",description:"Marker Entity"}),PickerRaycast.attributes.add("videoOne",{type:"entity",title:"LNT 1 Video Entity",description:"VideoOne Entity"}),PickerRaycast.attributes.add("videoTwo",{type:"entity",title:"LNT 2 Video Entity",description:"VideoTwo Entity"}),this.iframesrc="https://tokbox.com/embed/embed/ot-embed.js?embedId=a122f89f-4552-4e54-a807-37fdbd6c1495&room=DEFAULT_ROOM&iframe=true",PickerRaycast.prototype.initialize=function(){this.app.mouse.on(pc.EVENT_MOUSEUP,this.onSelect,this)},PickerRaycast.prototype.onSelect=function(t){var e=this.app.graphicsDevice.width/2,i=this.app.graphicsDevice.height/2,a=this.entity.camera.screenToWorld(e,i,this.entity.camera.nearClip),s=this.entity.camera.screenToWorld(e,i,this.entity.camera.farClip),n=this.videoOne,r=this.videoTwo;this.app;this.app.systems.rigidbody.raycastFirst(a,s,function(t){var e=t.entity;if(e.tags.has("VideoCallButton"))pc.app.fire("UnlockCursor"),document.getElementById("Modal2").classList.add("in","animated","slideInDown"),document.getElementById("videoCallFrame").src=this.iframesrc;else if(e.tags.has("MenuButton")){pc.app.fire("UnlockCursor"),document.getElementById("myModal").classList.add("in","animated","slideInDown")}else e.tags.has("ExitButton")?(n.script.videoTextureOnlineLnt1.playPause(),r.script.videoTextureOnlineLnt2.playPause()):e.tags.has("RegisterationFormButton")?e.script.pulseSingle:e.tags.has("VideoPlayPauseButton1")?n.script.videoTextureOnlineLnt1.playPause():e.tags.has("VideoPlayPauseButton2")?(r.script.videoTextureOnlineLnt2.playPause(),e.script.pulseSingle):e.tags.has("VideoMuteUnmuteButton1")?(n.script.videoTextureOnlineLnt1.muteUnmute(),e.script.pulseSingle):e.tags.has("VideoMuteUnmuteButton2")&&(r.script.videoTextureOnlineLnt2.muteUnmute(),e.script.pulseSingle)})};var Pulse=pc.createScript("pulse");Pulse.attributes.add("pulseTimeSecs",{type:"number",default:2,title:"Pulse Time Secs"}),Pulse.prototype.initialize=function(){this.secsSinceStart=this.pulseTimeSecs+1,this.entity.on("pulse:start",this.onStartEvent,this)},Pulse.prototype.update=function(t){if(this.secsSinceStart+=t,this.secsSinceStart<=this.pulseTimeSecs){var e=this.secsSinceStart/this.pulseTimeSecs,s=.3*(2*Math.abs(e-.5))+.7,i=this.entity.getLocalScale();i.set(s,s,s),this.entity.setLocalScale(i)}},Pulse.prototype.onStartEvent=function(){this.secsSinceStart=0};var PulseSingle=pc.createScript("pulseSingle");PulseSingle.prototype.initialize=function(){this.factor=0},PulseSingle.prototype.pulse=function(){this.factor=1},PulseSingle.prototype.update=function(t){if(this.factor>0){this.factor-=5*t;var i=1+Math.sin(5*this.factor)*this.factor;this.entity.setLocalScale(i,i,i)}};var ExitButton=pc.createScript("exitButton");ExitButton.attributes.add("lerpEntity",{type:"entity",title:"Lerp Entity",description:"Lerp Entity"}),ExitButton.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity",description:"Camera Entity"}),ExitButton.attributes.add("turnOnEntity",{type:"entity",title:"Turn On Entity",description:"Turn On Entity"}),ExitButton.attributes.add("exitEntity",{type:"entity",title:"Exit Entity",description:"Exit Entity"}),ExitButton.prototype.initialize=function(){this.app.mouse.on(pc.EVENT_MOUSEUP,this.onSelect,this)},ExitButton.prototype.onSelect=function(t){var i=this.app.graphicsDevice.width/2,e=this.app.graphicsDevice.height/2,n=this.turnOnEntity,r=this.cameraEntity.camera.screenToWorld(i,e,this.cameraEntity.camera.nearClip),a=this.cameraEntity.camera.screenToWorld(i,e,this.cameraEntity.camera.farClip);this.app.systems.rigidbody.raycastFirst(r,a,function(t){var i=t.entity;i.tags.has("LNTExitButton")&&(this.pc.app.fire("playerlerp:lnt"),pc.app.fire("HideScreen"),i.script.pulseSingle&&i.script.pulseSingle.pulse()),i.tags.has("MercExitButton")&&(this.pc.app.fire("playerlerp:merc"),pc.app.fire("HideScreen"),n.enabled=!1,i.script.pulseSingle&&i.script.pulseSingle.pulse())})};var PointTomarker=pc.createScript("pointTomarker");PointTomarker.attributes.add("markerEntity",{type:"entity",title:"Marker Entity",description:"Marker Entity"}),PointTomarker.prototype.initialize=function(){},PointTomarker.prototype.update=function(t){};var CommonButtonListener=pc.createScript("commonButtonListener");CommonButtonListener.attributes.add("playerEntity",{type:"entity",title:"Player Entity",description:"Player Entity"}),CommonButtonListener.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity",description:"Camera Entity"}),CommonButtonListener.attributes.add("backEntity",{type:"entity",title:"Back Button",description:"Back Button"}),CommonButtonListener.attributes.add("videoCallEntity",{type:"entity",title:"Video Call Button",description:"Video Call Button "}),CommonButtonListener.attributes.add("menuEntity",{type:"entity",title:"Menu Screen Button",description:"Menu Screen Button  "}),CommonButtonListener.attributes.add("markerLNTEntity",{type:"entity",title:"LNT Marker Entity",description:"LNT Marker Entity"}),CommonButtonListener.attributes.add("lerpScript",{type:"entity",title:"Lerp Script",description:"Lerp Script Entity"}),CommonButtonListener.attributes.add("stallCanvasUI",{type:"entity",title:"Stall Canvas UI",description:"Stall Canvas UI"}),CommonButtonListener.prototype.initialize=function(){this.backEntity.element.on("click",function(t){this.backScreen()},this),this.videoCallEntity.element.on("click",function(t){this.videoCallModal()},this),this.menuEntity.element.on("click",function(t){this.menuModalOpen()},this)},CommonButtonListener.prototype.update=function(t){},CommonButtonListener.prototype.backScreen=function(t){this.lerpScript.script.lerp.targetPosition=this.markerLNTEntity.getLocalPosition,this.stallCanvasUI.enabled=!1},CommonButtonListener.prototype.videoCallModal=function(t){document.getElementById("Modal2").classList.add("in","animated","slideInDown"),document.getElementById("videoCallFrame").src=this.iframesrc,this.app.mouse.disablePointerLock(),this.playerEntity.script.firstPersonMovement.allowLock=!1,this.cameraEntity.camera.fov=60},CommonButtonListener.prototype.menuModalOpen=function(t){document.getElementById("myModal").classList.add("in","animated","slideInDown"),this.app.mouse.disablePointerLock(),this.playerEntity.script.firstPersonMovement.allowLock=!1};var TurnCar=pc.createScript("turnCar");TurnCar.prototype.update=function(t){this.entity.rotate(0,.09,0)};var uni_video_lnt_1,VideoTextureOnlineLnt1=pc.createScript("videoTextureOnlineLnt1");VideoTextureOnlineLnt1.attributes.add("materials",{type:"asset",assetType:"material",array:!0}),VideoTextureOnlineLnt1.attributes.add("videoUrl",{type:"string"}),VideoTextureOnlineLnt1.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity",description:"Camera Entity"}),VideoTextureOnlineLnt1.attributes.add("playPasueButton",{type:"entity",title:"Play/Pause Button",description:"Play/Pause Button"}),VideoTextureOnlineLnt1.attributes.add("muteUnmuteButton",{type:"entity",title:"Mute/Unmute Button",description:"Mute/Unmute Button"}),VideoTextureOnlineLnt1.attributes.add("playPauseSprites",{type:"asset",assetType:"sprite",array:!0}),VideoTextureOnlineLnt1.attributes.add("muteUnmuteSprites",{type:"asset",assetType:"sprite",array:!0}),VideoTextureOnlineLnt1.prototype.initialize=function(){this.play=!0,this.mute=!0,this.app.on("PlayPause",this.showCursor,this);var t=this.app,e=new pc.Texture(t.graphicsDevice,{format:pc.PIXELFORMAT_R5_G6_B5,autoMipmap:!1});e.minFilter=pc.FILTER_LINEAR,e.magFilter=pc.FILTER_LINEAR,e.addressU=pc.ADDRESS_CLAMP_TO_EDGE,e.addressV=pc.ADDRESS_CLAMP_TO_EDGE;var i=document.createElement("video");uni_video_lnt_1=i,i.addEventListener("canplay",function(t){e.setSource(i)}),i.src=this.videoUrl,i.crossOrigin="anonymous",i.loop=!0,i.volume=.5,i.muted=!0,i.play(),i.controls=!0;for(var s=0;s<this.materials.length;s++){var n=this.materials[s].resource;n.emissiveMap=e,n.update()}this.videoTexture=e,this.upload=!0},VideoTextureOnlineLnt1.prototype.playPause=function(){this.play=!this.play,this.play?(console.log("Play, ",this.play),uni_video_lnt_1.play(),this.playPasueButton.sprite.spriteAsset=this.playPauseSprites[1]):(this.playPasueButton.sprite.spriteAsset=this.playPauseSprites[0],console.log(uni_video),uni_video_lnt_1.pause())},VideoTextureOnlineLnt1.prototype.muteUnmute=function(){this.mute=!this.mute,this.mute?(console.log("Muted, ",this.mute),uni_video_lnt_1.muted=this.mute,this.muteUnmuteButton.sprite.spriteAsset=this.muteUnmuteSprites[1]):!1===this.mute&&(console.log("Unmuted, ",this.mute),uni_video_lnt_1.muted=this.mute,this.muteUnmuteButton.sprite.spriteAsset=this.muteUnmuteSprites[0])},VideoTextureOnlineLnt1.prototype.update=function(t){this.upload=!this.upload,this.upload&&this.videoTexture.upload()};var uni_video_lnt_2,VideoTextureOnlineLnt2=pc.createScript("videoTextureOnlineLnt2");VideoTextureOnlineLnt2.attributes.add("materials",{type:"asset",assetType:"material",array:!0}),VideoTextureOnlineLnt2.attributes.add("videoUrl",{type:"string"}),VideoTextureOnlineLnt2.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity",description:"Camera Entity"}),VideoTextureOnlineLnt2.attributes.add("playPasueButton",{type:"entity",title:"Play/Pause Button",description:"Play/Pause Button"}),VideoTextureOnlineLnt2.attributes.add("muteUnmuteButton",{type:"entity",title:"Mute/Unmute Button",description:"Mute/Unmute Button"}),VideoTextureOnlineLnt2.attributes.add("playPauseSprites",{type:"asset",assetType:"sprite",array:!0}),VideoTextureOnlineLnt2.attributes.add("muteUnmuteSprites",{type:"asset",assetType:"sprite",array:!0}),VideoTextureOnlineLnt2.prototype.initialize=function(){this.play=!0,this.mute=!0,this.app.on("PlayPause",this.showCursor,this);var t=this.app,e=new pc.Texture(t.graphicsDevice,{format:pc.PIXELFORMAT_R5_G6_B5,autoMipmap:!1});e.minFilter=pc.FILTER_LINEAR,e.magFilter=pc.FILTER_LINEAR,e.addressU=pc.ADDRESS_CLAMP_TO_EDGE,e.addressV=pc.ADDRESS_CLAMP_TO_EDGE;var i=document.createElement("video");uni_video_lnt_2=i,i.addEventListener("canplay",function(t){e.setSource(i)}),i.src=this.videoUrl,i.crossOrigin="anonymous",i.loop=!0,i.muted=!0,i.play(),i.controls=!0;for(var s=0;s<this.materials.length;s++){var n=this.materials[s].resource;n.emissiveMap=e,n.update()}this.videoTexture=e,this.upload=!0},VideoTextureOnlineLnt2.prototype.playPause=function(){this.play=!this.play,this.play?(console.log("Play, ",this.play),console.log(uni_video_lnt_2),uni_video_lnt_2.play(),this.playPasueButton.sprite.spriteAsset=this.playPauseSprites[1]):(console.log("Paused, ",this.play),console.log(uni_video_lnt_2),uni_video_lnt_2.pause(),this.playPasueButton.sprite.spriteAsset=this.playPauseSprites[0])},VideoTextureOnlineLnt2.prototype.muteUnmute=function(){this.mute=!this.mute,this.mute?(console.log("Muted, ",this.mute),console.log(uni_video_lnt_2),uni_video_lnt_2.muted=this.mute,this.muteUnmuteButton.sprite.spriteAsset=this.muteUnmuteSprites[1]):!1===this.mute&&(console.log("Unmuted, ",this.mute),console.log(uni_video_lnt_2),uni_video_lnt_2.muted=this.mute,this.muteUnmuteButton.sprite.spriteAsset=this.muteUnmuteSprites[0])},VideoTextureOnlineLnt2.prototype.update=function(t){this.upload=!this.upload,this.upload&&this.videoTexture.upload()};var uni_video_merc,VideoTextureOnlineMerc=pc.createScript("videoTextureOnlineMerc");VideoTextureOnlineMerc.attributes.add("materials",{type:"asset",assetType:"material",array:!0}),VideoTextureOnlineMerc.attributes.add("videoUrl",{type:"string"}),VideoTextureOnlineMerc.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity",description:"Camera Entity"}),VideoTextureOnlineMerc.prototype.initialize=function(){this.play1=!0,this.play2=!0,this.mute1=!0,this.mute2=!0,this.app.on("PlayPause",this.showCursor,this);var e=this.app,t=new pc.Texture(e.graphicsDevice,{format:pc.PIXELFORMAT_R5_G6_B5,autoMipmap:!1});t.minFilter=pc.FILTER_LINEAR,t.magFilter=pc.FILTER_LINEAR,t.addressU=pc.ADDRESS_CLAMP_TO_EDGE,t.addressV=pc.ADDRESS_CLAMP_TO_EDGE;var i=document.createElement("video");uni_video_merc=i,i.addEventListener("canplay",function(e){t.setSource(i)}),i.src=this.videoUrl,i.crossOrigin="anonymous",i.loop=!0,i.muted=!0,i.play(),i.controls=!0;for(var o=0;o<this.materials.length;o++){var r=this.materials[o].resource;r.emissiveMap=t,r.update()}this.videoTexture=t,this.upload=!0},VideoTextureOnlineMerc.prototype.playPause=function(){this.play=!this.play,this.play?(console.log("Play, ",this.play),console.log(uni_video_merc),uni_video_merc.play()):(console.log("Paused, ",this.play),console.log(uni_video_merc),uni_video_merc.pause())},VideoTextureOnlineMerc.prototype.muteUnmute=function(){this.mute=!this.mute,this.mute?(console.log("Muted, ",this.mute),console.log(uni_video),uni_video_merc.muted=this.mute):!1===this.mute&&(console.log("Unmuted, ",this.mute),console.log(uni_video_merc),uni_video_merc.muted=this.mute)},VideoTextureOnlineMerc.prototype.update=function(e){this.upload=!this.upload,this.upload&&this.videoTexture.upload()};var FigureImage=pc.createScript("figureImage");FigureImage.attributes.add("images",{type:"asset",array:!0}),FigureImage.prototype.initialize=function(){this.entity.element.opacity=0,this.opacity={value:0}},FigureImage.prototype.FadeIn=function(){this.opacity.value=this.entity.element.opacity,this.tween&&this.tween.stop(),this.tween=this.entity.tween(this.opacity).on("update",this.onFadeIn,this).to({value:1},1,pc.SineOut).start()},FigureImage.prototype.onFadeIn=function(t){this.entity.element.opacity=this.opacity.value},FigureImage.prototype.onFadeOut=function(t){this.entity.element.opacity=this.opacity.value},FigureImage.prototype.FadeOut=function(){this.opacity.value=this.entity.element.opacity,this.tween&&this.tween.stop(),this.tween=this.entity.tween(this.opacity).on("update",this.onFadeOut,this).to({value:0},1,pc.SineOut).start()};var Figure=pc.createScript("figure");Figure.prototype.initialize=function(){},Figure.prototype.update=function(i){};var DistanceFromCamera=pc.createScript("distanceFromCamera");DistanceFromCamera.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),DistanceFromCamera.attributes.add("pointnclickScript",{type:"entity",title:"Floor Entity"}),DistanceFromCamera.attributes.add("targetEntity",{type:"entity",title:"Target Entity"}),DistanceFromCamera.attributes.add("distance",{type:"number",title:"Target Distance"}),DistanceFromCamera.prototype.initialize=function(){},DistanceFromCamera.prototype.update=function(t){this.cameraEntity.getPosition().distance(this.targetEntity.getPosition())<this.distance?(this.targetEntity.enabled&&(this.targetEntity.enabled=!0),this.pointnclickScript.script.pointAndClick.validDistance=!0):(this.targetEntity.enabled=!1,this.pointnclickScript.script.pointAndClick.validDistance=!1)};var GoTosite=pc.createScript("goTosite");GoTosite.attributes.add("agendaurl",{type:"string",title:"Agenda URL"}),GoTosite.attributes.add("streamurl",{type:"string",title:"Stream URL"}),GoTosite.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),GoTosite.prototype.initialize=function(){this.app.mouse.on(pc.EVENT_MOUSEUP,this.onSelect,this);var t=localStorage.getItem("guest_token");console.log(t),this.callOnStart()},GoTosite.prototype.callOnStart=function(t){this.agendaurl,this.streamurl;if(token=localStorage.getItem("guest_token"),token){var e=new XMLHttpRequest,o={token:token};e.onreadystatechange=function(){if(console.log("response : ",e),4===e.readyState){var t=JSON.parse(e.responseText);console.log("status:"+t.status),200===t.status?console.log(t):400===t.status?window.location.href="/":console.log("No proper response")}},e.open("POST","/is_active_session",!0),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify(o))}},GoTosite.prototype.onSelect=function(t){var e=this.app.graphicsDevice.width/2,o=this.app.graphicsDevice.height/2,s=this.cameraEntity.camera.screenToWorld(e,o,this.cameraEntity.camera.nearClip),n=this.cameraEntity.camera.screenToWorld(e,o,this.cameraEntity.camera.farClip),a=this.agendaurl,i=this.streamurl;token=localStorage.getItem("guest_token"),this.app.systems.rigidbody.raycastFirst(s,n,function(t){var e=t.entity;if(e.tags.has("JumpToURLButton")){this.entity;if(token){var o=new XMLHttpRequest,s={token:token};o.onreadystatechange=function(){if(console.log("response : ",o),4===o.readyState){var t=JSON.parse(o.responseText);console.log("status:"+t.status),200===t.status?console.log(t):400===t.status?window.location.href="/":console.log("No proper response")}},o.open("POST","/is_active_session",!0),o.setRequestHeader("Content-Type","application/json"),o.send(JSON.stringify(s))}e.script.pulseSingle&&e.script.pulseSingle.pulse()}e.tags.has("AuditoriumSite")&&(token=localStorage.getItem("guest_token"),console.log(i+token),token?window.open(i+token,"_self"):console.log("No player token found"),e.script.pulseSingle&&e.script.pulseSingle.pulse()),e.tags.has("ExitToSite")&&(token=localStorage.getItem("guest_token"),console.log(a+token),token?window.open(a+token,"_self"):console.log("No player token found"),e.script.pulseSingle&&e.script.pulseSingle.pulse())})};var SampleRaycast=pc.createScript("sampleRaycast");SampleRaycast.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),SampleRaycast.attributes.add("markerEntity",{type:"entity",title:"Marker Entity"}),SampleRaycast.ray=new pc.Ray,SampleRaycast.hitPosition=new pc.Vec3,SampleRaycast.prototype.initialize=function(){this.groundShape=new pc.BoundingBox(new pc.Vec3(0,0,0),new pc.Vec3(50,.001,20)),this.direction=new pc.Vec3},SampleRaycast.prototype.update=function(t){var a=Marker.ray,e=Marker.hitPosition,i=this.app.graphicsDevice.width/2,r=this.app.graphicsDevice.height/2,c=this.cameraEntity.camera.screenToWorld(i,r,this.cameraEntity.camera.nearClip),o=this.cameraEntity.camera.screenToWorld(i,r,this.cameraEntity.camera.farClip);console.log("Camera pos : ",this.cameraEntity.getLocalPosition()),console.log("Camera rot : ",this.cameraEntity.getLocalEulerAngles()),console.log("Position : ",i,r),this.cameraEntity.camera.screenToWorld(i,r,this.cameraEntity.camera.farClip,a.direction),a.origin.copy(this.cameraEntity.getPosition()),a.direction.sub(a.origin).normalize();this.groundShape.intersectsRay(a,e),this.app.systems.rigidbody.raycastFirst(c,o);this.moveMarkerTo(e)},SampleRaycast.prototype.moveMarkerTo=function(t){this.markerEntity.setPosition(t)};var Marker=pc.createScript("markerSimple");Marker.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),Marker.attributes.add("markerEntity",{type:"entity",title:"Marker Entity"}),Marker.prototype.initialize=function(){this.groundShape=new pc.BoundingBox(new pc.Vec3(0,0,8),new pc.Vec3(50,.001,20)),this.direction=new pc.Vec3,this.distanceToTravel=0,this.targetPosition=new pc.Vec3},Marker.prototype.update=function(t){this.doRayCast()},Marker.ray=new pc.Ray,Marker.hitPosition=new pc.Vec3,Marker.prototype.doRayCast=function(){var t=Marker.ray,e=Marker.hitPosition,i=this.app.graphicsDevice.width/2,r=this.app.graphicsDevice.height/2;this.cameraEntity.camera.screenToWorld(i,r,this.cameraEntity.camera.farClip,t.direction),t.origin.copy(this.cameraEntity.getPosition()),t.direction.sub(t.origin).normalize(),this.groundShape.intersectsRay(t,e)?(this.markerEntity.enabled=!0,this.moveMarkerTo(e)):this.markerEntity.enabled=!1},Marker.prototype.moveMarkerTo=function(t){this.markerEntity.setPosition(t)};pc.extend(pc,function(){var e=15;function computeGaussian(e,t){return 1/Math.sqrt(2*Math.PI*t)*Math.exp(-e*e/(2*t*t))}function calculateBlurValues(t,s,r,o,i){t[0]=computeGaussian(0,i),s[0]=0,s[1]=0;var a,l,u=t[0];for(a=0,l=Math.floor(e/2);a<l;a++){var h=computeGaussian(a+1,i);t[2*a]=h,t[2*a+1]=h,u+=2*h;var n=2*a+1.5;s[4*a]=r*n,s[4*a+1]=o*n,s[4*a+2]=-r*n,s[4*a+3]=-o*n}for(a=0,l=t.length;a<l;a++)t[a]/=u}var t=function(t){var s={aPosition:pc.SEMANTIC_POSITION},r=["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition + 1.0) * 0.5;","}"].join("\n"),o=["precision "+t.precision+" float;","","varying vec2 vUv0;","","uniform sampler2D uBaseTexture;","uniform float uBloomThreshold;","","void main(void)","{","    vec4 color = texture2D(uBaseTexture, vUv0);","","    gl_FragColor = clamp((color - uBloomThreshold) / (1.0 - uBloomThreshold), 0.0, 1.0);","}"].join("\n"),i=["precision "+t.precision+" float;","","#define SAMPLE_COUNT "+e,"","varying vec2 vUv0;","","uniform sampler2D uBloomTexture;","uniform vec2 uBlurOffsets[SAMPLE_COUNT];","uniform float uBlurWeights[SAMPLE_COUNT];","","void main(void)","{","    vec4 color = vec4(0.0);","    for (int i = 0; i < SAMPLE_COUNT; i++)","    {","        color += texture2D(uBloomTexture, vUv0 + uBlurOffsets[i]) * uBlurWeights[i];","    }","","    gl_FragColor = color;","}"].join("\n"),a=["precision "+t.precision+" float;","","varying vec2 vUv0;","","uniform float uBloomEffectIntensity;","uniform sampler2D uBaseTexture;","uniform sampler2D uBloomTexture;","","void main(void)","{","    vec4 bloom = texture2D(uBloomTexture, vUv0) * uBloomEffectIntensity;","    vec4 base = texture2D(uBaseTexture, vUv0);","","    base *= (1.0 - clamp(bloom, 0.0, 1.0));","","    gl_FragColor = base + bloom;","}"].join("\n");this.extractShader=new pc.Shader(t,{attributes:s,vshader:r,fshader:o}),this.blurShader=new pc.Shader(t,{attributes:s,vshader:r,fshader:i}),this.combineShader=new pc.Shader(t,{attributes:s,vshader:r,fshader:a});var l=t.width,u=t.height;this.targets=[];for(var h=0;h<2;h++){var n=new pc.Texture(t,{format:pc.PIXELFORMAT_R8_G8_B8_A8,width:l>>1,height:u>>1});n.minFilter=pc.FILTER_LINEAR,n.magFilter=pc.FILTER_LINEAR,n.addressU=pc.ADDRESS_CLAMP_TO_EDGE,n.addressV=pc.ADDRESS_CLAMP_TO_EDGE;var f=new pc.RenderTarget(t,n,{depth:!1});this.targets.push(f)}this.bloomThreshold=.25,this.blurAmount=4,this.bloomIntensity=1.25,this.sampleWeights=new Float32Array(e),this.sampleOffsets=new Float32Array(2*e)};return(t=pc.inherits(t,pc.PostEffect)).prototype=pc.extend(t.prototype,{render:function(e,t,s){var r=this.device,o=r.scope;o.resolve("uBloomThreshold").setValue(this.bloomThreshold),o.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(r,this.targets[0],this.vertexBuffer,this.extractShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,1/this.targets[1].width,0,this.blurAmount),o.resolve("uBlurWeights[0]").setValue(this.sampleWeights),o.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),o.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),pc.drawFullscreenQuad(r,this.targets[1],this.vertexBuffer,this.blurShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,0,1/this.targets[0].height,this.blurAmount),o.resolve("uBlurWeights[0]").setValue(this.sampleWeights),o.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),o.resolve("uBloomTexture").setValue(this.targets[1].colorBuffer),pc.drawFullscreenQuad(r,this.targets[0],this.vertexBuffer,this.blurShader),o.resolve("uBloomEffectIntensity").setValue(this.bloomIntensity),o.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),o.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(r,t,this.vertexBuffer,this.combineShader,s)}}),{BloomEffect:t}}());var Bloom=pc.createScript("bloom");Bloom.attributes.add("bloomIntensity",{type:"number",default:1,min:0,title:"Intensity"}),Bloom.attributes.add("bloomThreshold",{type:"number",default:.25,min:0,max:1,precision:2,title:"Threshold"}),Bloom.attributes.add("blurAmount",{type:"number",default:4,min:1,title:"Blur amount"}),Bloom.prototype.initialize=function(){this.effect=new pc.BloomEffect(this.app.graphicsDevice),this.effect.bloomThreshold=this.bloomThreshold,this.effect.blurAmount=this.blurAmount,this.effect.bloomIntensity=this.bloomIntensity;var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("attr",function(e,t){this.effect[e]=t},this),this.on("state",function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)}),this.on("destroy",function(){e.removeEffect(this.effect)})};pc.extend(pc,function(){var t=function(t){this.shader=new pc.Shader(t,{attributes:{aPosition:pc.SEMANTIC_POSITION},vshader:["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition.xy + 1.0) * 0.5;","}"].join("\n"),fshader:["precision "+t.precision+" float;","uniform sampler2D uColorBuffer;","uniform float uBrightness;","uniform float uContrast;","varying vec2 vUv0;","void main() {","gl_FragColor = texture2D( uColorBuffer, vUv0 );","gl_FragColor.rgb += uBrightness;","if (uContrast > 0.0) {","gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) / (1.0 - uContrast) + 0.5;","} else {","gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) * (1.0 + uContrast) + 0.5;","}","}"].join("\n")}),this.brightness=0,this.contrast=0};return(t=pc.inherits(t,pc.PostEffect)).prototype=pc.extend(t.prototype,{render:function(t,e,r){var s=this.device,i=s.scope;i.resolve("uBrightness").setValue(this.brightness),i.resolve("uContrast").setValue(this.contrast),i.resolve("uColorBuffer").setValue(t.colorBuffer),pc.drawFullscreenQuad(s,e,this.vertexBuffer,this.shader,r)}}),{BrightnessContrastEffect:t}}());var BrightnessContrast=pc.createScript("brightnessContrast");BrightnessContrast.attributes.add("brightness",{type:"number",default:0,min:-1,max:1,precision:5,title:"Brightness"}),BrightnessContrast.attributes.add("contrast",{type:"number",default:0,min:-1,max:1,precision:5,title:"Contrast"}),BrightnessContrast.prototype.initialize=function(){this.effect=new pc.BrightnessContrastEffect(this.app.graphicsDevice),this.effect.brightness=this.brightness,this.effect.contrast=this.contrast,this.on("attr",function(t,e){this.effect[t]=e},this);var t=this.entity.camera.postEffects;t.addEffect(this.effect),this.on("state",function(e){e?t.addEffect(this.effect):t.removeEffect(this.effect)}),this.on("destroy",function(){t.removeEffect(this.effect)})};var ColorPicker=pc.createScript("colorPicker");ColorPicker.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity",description:"Camera Entity"}),ColorPicker.attributes.add("turnOnEntity",{type:"entity",title:"Turn On Entity",description:"Turn On Entity"}),ColorPicker.attributes.add("materials",{type:"asset",assetType:"material",array:!0,title:"Materials"}),ColorPicker.prototype.initialize=function(){this.app.mouse.on(pc.EVENT_MOUSEUP,this.onSelect,this)},ColorPicker.prototype.changeToNextMaterial=function(t){this.materialIndex=(this.materialIndex+1)%this.materials.length;for(var e=this.materials[this.materialIndex],a=this.entity.model.meshInstances,r=0;r<a.length;++r){if(2===r||25===r)a[r].material=e.resource}},ColorPicker.prototype.onSelect=function(t){var e=this.app.graphicsDevice.width/2,a=this.app.graphicsDevice.height/2,r=this.cameraEntity.camera.screenToWorld(e,a,this.cameraEntity.camera.nearClip),i=this.cameraEntity.camera.screenToWorld(e,a,this.cameraEntity.camera.farClip),s=(this.videoOne,this.videoTwo,this.app,this.entity.model.meshInstances),o=this.materials,n=this.turnOnEntity;this.app.systems.rigidbody.raycastFirst(r,i,function(t){var e,a,r,i,c=t.entity;c&&(c.tags.has("MercColorHotspot")&&(n.enabled=!0),c.tags.has("RedColor")?(e=o[0],a=o[0],r=s[2],i=s[24],r.material=e.resource,i.material=a.resource):c.tags.has("BlackColor")?(e=o[1],a=o[1],r=s[2],i=s[24],r.material=e.resource,i.material=a.resource):c.tags.has("BlueColor")?(e=o[2],a=o[2],r=s[2],i=s[24],r.material=e.resource,i.material=a.resource):c.tags.has("WhiteColor")&&(e=o[3],a=o[3],r=s[2],i=s[24],r.material=e.resource,i.material=a.resource))})};var AjaxCalling=pc.createScript("ajaxCalling");AjaxCalling.prototype.initialize=function(){localStorage.getItem("guest_id");this.callOnStart()},AjaxCalling.prototype.callOnStart=function(t){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(console.log("response : ",e),4===e.readyState){var t=JSON.parse(e.responseText);"200"===t.code||"400"===t.code&&console.log("Playerid ",playerid)}},e.open("POST","http://vtour.inkincaps.com/is_active_session/",!0),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify({guest_id:"Qrz9s034"}))},AjaxCalling.prototype.parseCharacterData=function(t){for(var e=[],a=t.characters,n=0;n<a.length;n++){var o=a[n];e.push(o.firstName+" "+o.lastName)}return e},AjaxCalling.prototype.update=function(t){};